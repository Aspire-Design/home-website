(function(e,t){function f(e){return this.lib[e]}function l(e){return typeof e==="boolean"?e:!!parseFloat(e)}function c(e){return s.percent.exec(e)?parseFloat(e)/100:e}function h(e,t,n,r){var i=[e,t];this.ontarget=false;this.decay=n;this.pointer=r||[.5,.5];this.update=function(e,t){var n,r;if(this.ontarget){this.pointer=e}else if((!i[0]||u(e[0]-this.pointer[0])<t[0])&&(!i[1]||u(e[1]-this.pointer[1])<t[1])){this.ontarget=true;this.pointer=e}else{n=[];r=2;while(r--){if(i[r]){n[r]=e[r]+this.decay*(this.pointer[r]-e[r])}}this.pointer=n}}}function p(t,r){var i=this,s=t instanceof e?t:e(t),o=[l(r.xparallax),l(r.yparallax)],u=0,a;this.pointer=[0,0];this.active=false;this.activeOutside=r&&r.activeOutside||false;this.update=function(e){var t=this.pos,n=this.size,r=[],i=2;if(u>0){if(u===2){u=0;if(a){e=a}}while(i--){if(o[i]){r[i]=(e[i]-t[i])/n[i];r[i]=r[i]<0?0:r[i]>1?1:r[i]}}this.active=true;this.pointer=r}else{this.active=false}};this.updateSize=function(){var e=s.width(),t=s.height();i.size=[e,t];i.threshold=[1/e,1/t]};this.updatePos=function(){var e=s.offset()||{left:0,top:0},t=parseInt(s.css("borderLeftWidth"))+parseInt(s.css("paddingLeft")),n=parseInt(s.css("borderTopWidth"))+parseInt(s.css("paddingTop"));i.pos=[e.left+t,e.top+n]};e(window).bind("resize."+n,i.updateSize).bind("resize."+n,i.updatePos);s.bind("mouseenter."+n,function(e){u=1}).bind("mouseleave."+n,function(e){u=2;a=[e.pageX,e.pageY]});this.updateSize();this.updatePos()}function d(e,n){var r=[],o=[],u=[],a=[];this.update=function(t){var n=[],i,s,f=2,l={};while(f--){if(o[f]){n[f]=o[f]*t[f]+u[f];if(r[f]){i=a[f];s=n[f]*-1}else{i=n[f]*100+"%";s=n[f]*this.size[f]*-1}if(f===0){l.left=i;l.marginLeft=s}else{l.top=i;l.marginTop=s}}}e.css(l)};this.setParallax=function(e,f,l,h){var p=[e||n.xparallax,f||n.yparallax],d=[l||n.xorigin,h||n.yorigin],v=2,m={};while(v--){r[v]=s.px.test(p[v]);if(typeof d[v]==="string"){d[v]=d[v]===t?1:i[d[v]]||c(d[v])}if(r[v]){o[v]=parseInt(p[v]);u[v]=d[v]*(this.size[v]-o[v]);a[v]=d[v]*100+"%"}else{o[v]=p[v]===true?1:c(p[v]);u[v]=o[v]?d[v]*(1-o[v]):0}}};this.getPointer=function(){var t=e.offsetParent(),n=e.position(),i=[],s=[],a=2;while(a--){if(r[a]){i[a]=0}else{i[a]=n[a===0?"left":"top"]/(t[a===0?"outerWidth":"outerHeight"]()-this.size[a])}s[a]=(i[a]-u[a])/o[a]}return s};this.setSize=function(t,n){this.size=[t||e.outerWidth(),n||e.outerHeight()]};this.setSize(n.width,n.height);this.setParallax(n.xparallax,n.yparallax,n.xorigin,n.yorigin)}function v(t){var r=e(this),i=t.data.global||t.data,s=t.data.local||r.data(n),u=i.port,f=i.mouse,l=s.mouse,c=i.timeStamp!==t.timeStamp;if(c){i.timeStamp=t.timeStamp;u.update(a);if(u.active||!f.ontarget){f.update(u.pointer,u.threshold)}}if(l){l.update(s.freeze?s.freeze.pointer:u.pointer,u.threshold);if(l.ontarget){delete s.mouse;if(s.freeze){r.unbind(o).addClass(i.freezeClass)}}f=l}else{if(f.ontarget&&!u.active){r.unbind(o)}}s.layer.update(f.pointer)}var n="parallax";var r={mouseport:"body",xparallax:true,yparallax:true,xorigin:.5,yorigin:.5,decay:.66,frameDuration:30,freezeClass:"freeze"},i={left:0,top:0,middle:.5,center:.5,right:1,bottom:1},s={px:/^\d+\s?px$/,percent:/^\d+\s?%$/},o="frame."+n,u=Math.abs,a=[0,0];f.lib=i;e.fn[n]=function(i){var s=e.extend({},e.fn[n].options,i),u=arguments,a=this,f=[];if(t===e.event.special.frame){throw"jquery.parallax requires jquery.event.frame."}if(!(s.mouseport instanceof e)){s.mouseport=e(s.mouseport)}s.port=new p(s.mouseport,s);s.mouse=new h(l(s.xparallax),l(s.yparallax),s.decay);s.mouseport.bind("mouseenter",function(t){var r=a.length,i;s.mouse.ontarget=false;while(r--){i=a[r];if(!e.data(i,n).freeze){e.event.add(this,o,v,{global:s,local:f[r]})}}});return a.each(function(i){var a=e(this),p=u[i+1]?e.extend({},s,u[i+1]):s,m=new d(a,p),g={layer:m,mouse:new h(l(p.xparallax),l(p.yparallax),p.decay,m.getPointer())};a.data(n,g);f.push(g);e.event.add(this,"freeze",function(n){var r=e(this),i=n.data.global,s=n.data.local,u=s.mouse||s.freeze||i.mouse,a=a=[n.x===t?u.pointer[0]:c(n.x),n.y===t?u.pointer[1]:c(n.y)],f=n.decay;s.freeze={pointer:a};s.mouse=new h(l(i.xparallax),l(i.yparallax),i.decay,u.pointer);if(f!==t){s.mouse.decay=f}e.event.add(this,o,v,i)},{global:s,local:g});e.event.add(this,"unfreeze",function(n){var i=e(this),s=n.data.global,u=n.data.local,a=n.decay,f;if(!u.freeze){return}f=u.mouse?u.mouse.pointer:u.freeze.pointer;u.mouse=new h(l(s.xparallax),l(s.yparallax),s);u.mouse.pointer=f;if(a!==t)u.mouse.decay=a;delete u.freeze;i.removeClass(r.freezeClass);e.event.add(this,o,v,s)},{global:s,local:g})})};e.fn[n].options=r;e(document).ready(function(){e(document).mousemove(function(e){a=[e.pageX,e.pageY]})})})(jQuery)